# Configure the controller manager deployment
manager:
  replicas: 1
  image:
    repository: "ghcr.io/crashappsec/ocular-controller"
    tag: "v0.2.6"
    pullPolicy: "IfNotPresent"
  # Additional labels to add to the controller manager deployment
  labels: {}
  # Additional annotations to add to the controller manager deployment
  annotations: {}
  command:
    - /entrypoint
  args:
    - --leader-elect
  # Additional environment variables to add to the controller manager container
  env: []
  # Additional volumes to add to the controller manager pod
  volumes: []
  volumeMounts: []
  # Pod-level security settings
  podSecurityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault
  # Container-level security settings
  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true
  # metrics
  # Resource limits and requests
  resources:
    limits:
      cpu: 500m
      memory: 128Mi
    requests:
      cpu: 10m
      memory: 64Mi
  ## manager pod's affinity
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: kubernetes.io/arch
                operator: In
                values:
                  - amd64
                  - arm64
                  - ppc64le
                  - s390x
              - key: kubernetes.io/os
                operator: In
                values:
                  - linux
  ## manager pod's node selector
  nodeSelector: {}
  ## manager pod's tolerations
  tolerations: []
# Configure the extractor image
# This is the image that is used by ocular
# To facilitate the transfer of artfacts from
# scanners to uploaders
sidecar:
  image:
    repository: "ghcr.io/crashappsec/ocular-sidecar"
    tag: "v0.2.6"
    pullPolicy: IfNotPresent
# Essential RBAC permissions (required for controller operation)
# These include ServiceAccount, controller permissions, leader election, and metrics access
# Note: Essential RBAC is always enabled as it's required for the controller to function

# Helper RBAC roles for managing custom resources
# These provide convenient admin/editor/viewer roles for each CRD type
# Useful for giving users different levels of access to your custom resources
rbacHelpers:
  enable: false # Install convenience admin/editor/viewer roles for CRDs
# Custom Resource Definitions
crd:
  enable: true # Install CRDs with the chart
  keep: true # Keep CRDs when uninstalling
# Controller metrics endpoint.
# Enable to expose /metrics endpoint with RBAC protection.
metrics:
  enable: true
  port: 8443
# Cert-manager integration for TLS certificates.
# Required for webhook certificates and metrics endpoint certificates.
certManager:
  enable: true
# Prometheus ServiceMonitor for metrics scraping.
# Requires prometheus-operator to be installed in the cluster.
prometheus:
  enable: false
webhook:
  port: 9443
